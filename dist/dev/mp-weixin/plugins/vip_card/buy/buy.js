(global.webpackJsonp=global.webpackJsonp||[]).push([["plugins/vip_card/buy/buy"],{1363:
/*!******************************************!*\
  !*** ./src/plugins/vip_card/buy/buy.vue ***!
  \******************************************/
/*! no static exports found */function(t,e,n){"use strict";n.r(e);var i=n(/*! ./buy.vue?vue&type=template&id=1dc56370&scoped=true&filter-modules=%7B%7D& */1364),a=n(/*! ./buy.vue?vue&type=script&lang=js& */1366);for(var o in a)"default"!==o&&function(t){n.d(e,t,function(){return a[t]})}(o);n(/*! ./buy.vue?vue&type=style&index=0&id=1dc56370&scoped=true&lang=scss& */1368);var r=n(/*! ../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js */10),d=Object(r.default)(a.default,i.render,i.staticRenderFns,!1,null,"1dc56370",null);d.options.__file="src/plugins/vip_card/buy/buy.vue",e.default=d.exports},1364:
/*!***********************************************************************************************************!*\
  !*** ./src/plugins/vip_card/buy/buy.vue?vue&type=template&id=1dc56370&scoped=true&filter-modules=%7B%7D& ***!
  \***********************************************************************************************************/
/*! exports provided: render, staticRenderFns */function(t,e,n){"use strict";n.r(e);var i=n(/*! -!../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--15-0!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../node_modules/vue-loader/lib??vue-loader-options!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./buy.vue?vue&type=template&id=1dc56370&scoped=true&filter-modules=%7B%7D& */1365);n.d(e,"render",function(){return i.render}),n.d(e,"staticRenderFns",function(){return i.staticRenderFns})},1365:
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--15-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./src/plugins/vip_card/buy/buy.vue?vue&type=template&id=1dc56370&scoped=true&filter-modules=%7B%7D& ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns */function(t,e,n){"use strict";n.r(e),n.d(e,"render",function(){return i}),n.d(e,"staticRenderFns",function(){return a});var i=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=function(e){t.showClose=!0})},a=[];i._withStripped=!0},1366:
/*!*******************************************************************!*\
  !*** ./src/plugins/vip_card/buy/buy.vue?vue&type=script&lang=js& ***!
  \*******************************************************************/
/*! no static exports found */function(t,e,n){"use strict";n.r(e);var i=n(/*! -!../../../../node_modules/babel-loader/lib!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../node_modules/vue-loader/lib??vue-loader-options!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./buy.vue?vue&type=script&lang=js& */1367),a=n.n(i);for(var o in i)"default"!==o&&function(t){n.d(e,t,function(){return i[t]})}(o);e.default=a.a},1367:
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./src/plugins/vip_card/buy/buy.vue?vue&type=script&lang=js& ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(t,e,n){"use strict";(function(t){function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o={data:function(){return{detail:{},list:{form:{card_bg:""}},card:{expire_day:"",type_info:{ignore_goods:[],ignore_cats:[]}},today:"",end_day:"",total_coupon:0,total_card:0,id:0,end_time:"",start_day:"",success:!1,iphone_x:!1,template_message:[],loading:!1,validateResult:{hasError:!1},showClose:!1,is_open:!1}},components:{AppDiyForm:function(){return n.e(/*! import() | components/page-component/app-diy-form/app-diy-form */"components/page-component/app-diy-form/app-diy-form").then(n.bind(null,/*! ../../../components/page-component/app-diy-form/app-diy-form */2724))},AppClose:function(){return n.e(/*! import() | components/basic-component/app-close/app-close */"components/basic-component/app-close/app-close").then(n.bind(null,/*! ../../../components/basic-component/app-close/app-close.vue */2618))}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(n,!0).forEach(function(e){a(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},(0,n(/*! vuex */12).mapState)({svipImg:function(t){return t.mallConfig.__wxapp_img.vip_card}})),methods:{getMall:function(t){this.is_open=1==t.is_open,this.is_open&&this.subscribe()},toDetail:function(){t.navigateTo({url:"/plugins/vip_card/rights/rights?id="+this.id})},toBack:function(){this.success=!1,t.navigateBack()},toCoupon:function(){t.navigateTo({url:"/pages/coupon/index/index"})},toCard:function(){t.navigateTo({url:"/pages/card/index/index"})},toBalance:function(){t.navigateTo({url:"/pages/balance/balance"})},toIntegral:function(){t.navigateTo({url:"/plugins/integral_mall/index/index"})},getSetting:function(){var e=this;e.$showLoading({type:"global",text:"加载中..."}),e.$request({url:e.$api.vip_card.setting}).then(function(n){0==n.code?(e.list=n.data,t.setNavigationBarTitle({title:"购买"+e.list.name}),e.template_message=n.data.template_message,e.getCard()):t.showToast({title:n.msg,icon:"none",duration:1e3})}).catch(function(t){e.$hideLoading()})},getCard:function(){var e=this;e.$request({url:e.$api.vip_card.card_detail,data:{id:this.id}}).then(function(n){if(e.$hideLoading(),0==n.code){e.card=n.data;var i=Date.parse(new Date);e.end_time>0&&(i=Date.parse(new Date(e.end_time)));var a=1e3*(i/1e3+86400*n.data.expire_day),o=new Date(a),r=o.getFullYear(),d=o.getMonth()+1;d>=1&&d<=9&&(d="0"+d);var s=o.getDate();s>=1&&s<=9&&(s="0"+s),e.end_day=r+"/"+d+"/"+s,e.card.coupons.forEach(function(t){e.total_coupon+=+t.send_num}),e.card.cards.forEach(function(t){e.total_card+=+t.send_num})}else t.showToast({title:n.msg,icon:"none",duration:1e3})}).catch(function(t){e.$hideLoading()})},subscribe:function(){var e=this;if(!this.validateResult.hasError)return!!this.is_open&&void this.$subscribe(this.template_message).then(function(t){e.toSubmit()}).catch(function(t){e.toSubmit()});t.showToast({title:this.validateResult.errors[0].msg,icon:"none"})},toSubmit:function(){var e=this;if(this.loading)return!1;this.loading=!0,t.showLoading({mask:!0,title:"购买中..."}),e.$request({url:e.$api.vip_card.order_submit,data:{id:this.id,order_form:JSON.stringify(e.list.order_form)},method:"post"}).then(function(n){0===n.code?e.getPayOrderId(n.data.queue_id,n.data.token):(e.loading=!1,t.hideLoading(),t.showModal({title:"提示",content:n.msg,showCancel:!1}))}).catch(function(n){e.loading=!1,t.hideLoading(),t.showModal({title:"提示",content:n.errMsg,showCancel:!1})})},handleOrderFormValidate:function(t){var e=t.result;this.validateResult=e,this.showClose=!1},handleGoodsFormInput:function(t){var e=t.data,n=(t.sign,[]);for(var i in e)n[i]={key:e[i].key,label:e[i].name,value:e[i].value,required:e[i].is_required};this.list.order_form=n},getPayOrderId:function(e,n){var i=this;this.$request({url:this.$api.vip_card.pay_data,method:"post",data:{queue_id:e,token:n}}).then(function(a){0===a.code?a.data.retry&&1===a.data.retry?i.getPayDataTimer=setTimeout(function(){i.getPayOrderId(e,n)},1e3):i.pay(a.data.id):(t.hideLoading(),i.loading=!1,t.showModal({title:"提示",content:a.msg,showCancel:!1}))}).catch(function(e){i.loading=!1,t.hideLoading(),t.showModal({title:"提示",content:e.errMsg,showCancel:!1})})},pay:function(e){var n=this;n.$payment.pay(e).then(function(e){t.hideLoading(),n.loading=!1,t.showToast({title:"购买成功",duration:1e3}),n.card.send_integral_num>0||n.card.send_balance>0||n.card.coupons.length>0||n.card.cards.length>0?n.success=!0:setTimeout(function(e){t.navigateBack()},1e3)}).catch(function(e){t.hideLoading(),n.loading=!1,t.showToast({title:"支付失败",icon:"none",duration:1e3})})}},onUnload:function(){clearInterval(this.getPayDataTimer)},onLoad:function(e){this.$commonLoad.onload(e);var n=this;t.getSystemInfo({success:function(t){(t.model.indexOf("iPhone X")>-1||t.model.indexOf("iPhone 11")>-1||t.model.indexOf("iPhone11")>-1||t.model.indexOf("iPhone12")>-1)&&(n.iphone_x=!0)}});var i=new Date,a=i.getFullYear(),o=i.getMonth()+1;o>=1&&o<=9&&(o="0"+o);var r=i.getDate();r>=1&&r<=9&&(r="0"+r),this.today=a+"/"+o+"/"+r,this.id=e.id,this.end_time=e.end,this.expire_day=e.expire_day?e.expire_day:0,n.getSetting(e.id)}};e.default=o}).call(this,n(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1).default)},1368:
/*!****************************************************************************************************!*\
  !*** ./src/plugins/vip_card/buy/buy.vue?vue&type=style&index=0&id=1dc56370&scoped=true&lang=scss& ***!
  \****************************************************************************************************/
/*! no static exports found */function(t,e,n){"use strict";n.r(e);var i=n(/*! -!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-1!../../../../node_modules/css-loader??ref--8-oneOf-1-2!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src??ref--8-oneOf-1-3!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!../../../../node_modules/vue-loader/lib??vue-loader-options!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./buy.vue?vue&type=style&index=0&id=1dc56370&scoped=true&lang=scss& */1369),a=n.n(i);for(var o in i)"default"!==o&&function(t){n.d(e,t,function(){return i[t]})}(o);e.default=a.a},1369:
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-1!./node_modules/css-loader??ref--8-oneOf-1-2!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src??ref--8-oneOf-1-3!./node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!./node_modules/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./src/plugins/vip_card/buy/buy.vue?vue&type=style&index=0&id=1dc56370&scoped=true&lang=scss& ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(t,e,n){},18:
/*!*********************************!*\
  !*** external "../siteinfo.js" ***!
  \*********************************/
/*! no static exports found */function(t,e){t.exports=require("../siteinfo.js")}},[[1362,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../../.sourcemap/mp-weixin/plugins/vip_card/buy/buy.js.map