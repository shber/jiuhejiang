(global.webpackJsonp=global.webpackJsonp||[]).push([["plugins/bargain/activity/activity"],{2067:
/*!***************************************************!*\
  !*** ./src/plugins/bargain/activity/activity.vue ***!
  \***************************************************/
/*! no static exports found */function(t,i,e){"use strict";e.r(i);var n=e(/*! ./activity.vue?vue&type=template&id=779c3b9a&scoped=true&filter-modules=%7B%7D& */2068),a=e(/*! ./activity.vue?vue&type=script&lang=js& */2070);for(var r in a)"default"!==r&&function(t){e.d(i,t,function(){return a[t]})}(r);e(/*! ./activity.vue?vue&type=style&index=0&id=779c3b9a&scoped=true&lang=scss& */2072);var o=e(/*! ../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js */10),s=Object(o.default)(a.default,n.render,n.staticRenderFns,!1,null,"779c3b9a",null);s.options.__file="src/plugins/bargain/activity/activity.vue",i.default=s.exports},2068:
/*!********************************************************************************************************************!*\
  !*** ./src/plugins/bargain/activity/activity.vue?vue&type=template&id=779c3b9a&scoped=true&filter-modules=%7B%7D& ***!
  \********************************************************************************************************************/
/*! exports provided: render, staticRenderFns */function(t,i,e){"use strict";e.r(i);var n=e(/*! -!../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--15-0!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../node_modules/vue-loader/lib??vue-loader-options!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./activity.vue?vue&type=template&id=779c3b9a&scoped=true&filter-modules=%7B%7D& */2069);e.d(i,"render",function(){return n.render}),e.d(i,"staticRenderFns",function(){return n.staticRenderFns})},2069:
/*!******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--15-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./src/plugins/bargain/activity/activity.vue?vue&type=template&id=779c3b9a&scoped=true&filter-modules=%7B%7D& ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns */function(t,i,e){"use strict";e.r(i),e.d(i,"render",function(){return n}),e.d(i,"staticRenderFns",function(){return a});var n=function(){var t=this,i=t.$createElement;t._self._c;t._isMounted||(t.e0=function(i){t.dialog=!1},t.e1=function(i){t.tip=""})},a=[];n._withStripped=!0},2070:
/*!****************************************************************************!*\
  !*** ./src/plugins/bargain/activity/activity.vue?vue&type=script&lang=js& ***!
  \****************************************************************************/
/*! no static exports found */function(t,i,e){"use strict";e.r(i);var n=e(/*! -!../../../../node_modules/babel-loader/lib!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../node_modules/vue-loader/lib??vue-loader-options!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./activity.vue?vue&type=script&lang=js& */2071),a=e.n(n);for(var r in n)"default"!==r&&function(t){e.d(i,t,function(){return n[t]})}(r);i.default=a.a},2071:
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./src/plugins/bargain/activity/activity.vue?vue&type=script&lang=js& ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(t,i,e){"use strict";(function(t){function n(t,i){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);i&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),e.push.apply(e,n)}return e}function a(t,i,e){return i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r={name:"activity",data:function(){return{detail:{bargain_price_per:0},list:[],distance:0,more:!1,sizeAnimation:{},status:1,animationData:"",kanjia:!1,dialog:!1,info:{},bargain:{},toMore:!1,page:1,dd:0,hh:23,mm:59,ss:59,changeTimer:null,timer:null,tip:"",title:"",order_id:""}},computed:function(t){for(var i=1;i<arguments.length;i++){var e=null!=arguments[i]?arguments[i]:{};i%2?n(e,!0).forEach(function(i){a(t,i,e[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):n(e).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))})}return t}({},(0,e(/*! vuex */12).mapState)({userInfo:function(t){return t.user.info},bargainImg:function(t){return t.mallConfig.plugin.bargain},mall:function(t){return t.mallConfig.mall}})),onShareAppMessage:function(){return this.hShareAppMessage()},onUnload:function(){clearInterval(this.timer),clearInterval(this.changeTimer)},onLoad:function(t){this.$commonLoad.onload(t);var i=this;i.$store.dispatch("user/info"),i.$showLoading({type:"global",text:"加载中..."}),i.getSetting();var e=setInterval(function(){i.userInfo&&(clearInterval(e),t.order_id?(i.join(t.order_id),i.order_id=t.order_id):t.id?(i.getDetail(t.id,1),i.order_id=t.id):t.bargain_order_id&&(i.order_id=t.bargain_order_id,t.user_id==i.userInfo.options.user_id?i.getDetail(t.bargain_order_id,1):(i.status=2,i.join(t.bargain_order_id))),i.changeTimer=setInterval(function(){i.changeSize()},300))},300)},methods:{hShareAppMessage:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=this;return this.$shareAppMessage({title:i.title,path:"/plugins/bargain/activity/activity",imageUrl:i.detail.app_share_pic?i.detail.app_share_pic:"",params:{user_id:i.userInfo.options.user_id,bargain_order_id:i.order_id}},t)},toRules:function(){t.navigateTo({url:"/pages/rules/index?url=".concat(encodeURIComponent(this.$api.bargain.setting),"&key=rule")})},getSetting:function(){var i=this;i.$request({url:i.$api.bargain.setting}).then(function(e){if(0===e.code){if(i.title=e.data.title.toString(),e.data.title.indexOf("\n")>-1){var n=e.data.title.split("\n"),a=Math.floor(Math.random()*n.length);i.title=n[a]}}else t.showToast({title:e.msg,icon:"none",duration:1e3})}).catch(function(t){i.$hideLoading()})},join:function(i){var e=this;e.$request({url:e.$api.bargain.user_join_bargain,data:{bargain_order_id:i}}).then(function(n){if(0==n.code){var a=n.data.queueId,r=n.data.token;e.result(a,r,i)}else t.showToast({title:n.msg,icon:"none",duration:1e3}),"用户已参与本次砍价"==n.msg&&e.getDetail(i,1)}).catch(function(t){e.$hideLoading()})},result:function(i,e,n){var a=this;a.$request({url:a.$api.bargain.user_join_bargain_result,data:{queueId:i,token:e}}).then(function(r){0==r.code?1==r.data.retry?setTimeout(function(){a.result(i,e,n)},1e3):(a.$hideLoading(),a.info=r.data.info,a.bargain=r.data.bargain,a.bargainAnimation(),a.getDetail(n,1)):"已砍至最低价"==r.msg?(a.tip=r.msg,a.getDetail(n,1)):t.showToast({title:r.msg,icon:"none",duration:1e3})}).catch(function(t){a.$hideLoading()})},getDetail:function(i,e){var n=this;n.$request({url:n.$api.bargain.activity,data:{bargain_order_id:i,page:e}}).then(function(i){if(setTimeout(function(){n.$hideLoading()},500),0==i.code)if(i.data.list.length>0){if(n.detail=i.data,i.data.total_people>3&&(n.toMore=!0,3==i.data.list.length?n.more=!0:n.more=!1),n.list=n.list.concat(i.data.list),1==e){var a=n.detail.reset_time;n.timer=setInterval(function(){a--,n.getTime(a),0==n.reset_time&&clearInterval(n.timer)},1e3)}}else n.tip="暂无更多用户",n.toMore=!1;else t.showModal({title:"提示",content:i.data.msg,showCancel:!1,success:function(i){i.confirm&&t.redirectTo({url:"/pages/index/index"})}})}).catch(function(t){n.$hideLoading()})},getTime:function(t){t>86399?(this.dd=Math.floor(t/86400),t-=86400*this.dd):this.dd=0,t>3599?(this.hh=Math.floor(t/3600),this.hh<10&&(this.hh="0"+this.hh),t-=3600*this.hh):this.hh="00",t>59?(this.mm=Math.floor(t/60),this.mm<10&&(this.mm="0"+this.mm),t-=60*this.mm):this.mm="00",t<60&&(this.ss=t,this.ss<10&&(this.ss="0"+this.ss))},bargainAnimation:function(){var t=this;t.kanjia=!0,t.dialog=!0,setTimeout(function(){t.kanjia=!1,t.success()},1200),t.$forceUpdate()},lookMore:function(){this.page++,this.getDetail(this.order_id,this.page)},closeList:function(){this.list=this.list.slice(0,3),this.page=1,this.more=!0},success:function(){this.dialog=!0;var i=t.createAnimation({duration:500,timingFunction:"linear"});this.animation=i,i.scale(1).step().rotate(2).step().rotate(-2).step().rotate(0).step(),this.animationData=i.export()},changeSize:function(){var i=t.createAnimation({duration:1e3,timingFunction:"linear"});this.size=i,i.scale(.8).step().scale(1).step(),this.sizeAnimation=i.export()},toIndex:function(){t.reLaunch({url:"/pages/index/index"})},toBuy:function(){var i=this.detail,e=[{mch_id:0,bargain_order_id:i.bargain_order_id,goods_list:[{id:i.goods_id,attr:[],num:1,cart_id:0,goods_attr_id:i.goods_attr_id}]}];t.navigateTo({url:"/pages/order-submit/order-submit?mch_list="+JSON.stringify(e)+"&preview_url="+encodeURIComponent(this.$api.bargain.order_preview)+"&submit_url="+encodeURIComponent(this.$api.bargain.order_submit)})},toJoin:function(){this.detail.goods_id?t.navigateTo({url:"/plugins/bargain/goods/goods?goods_id="+this.detail.goods_id}):t.showModal({title:"提示",content:"活动已结束",showCancel:!1,success:function(i){i.confirm&&t.redirectTo({url:"/pages/index/index"})}})}}};i.default=r}).call(this,e(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1).default)},2072:
/*!*************************************************************************************************************!*\
  !*** ./src/plugins/bargain/activity/activity.vue?vue&type=style&index=0&id=779c3b9a&scoped=true&lang=scss& ***!
  \*************************************************************************************************************/
/*! no static exports found */function(t,i,e){"use strict";e.r(i);var n=e(/*! -!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-1!../../../../node_modules/css-loader??ref--8-oneOf-1-2!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src??ref--8-oneOf-1-3!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!../../../../node_modules/vue-loader/lib??vue-loader-options!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./activity.vue?vue&type=style&index=0&id=779c3b9a&scoped=true&lang=scss& */2073),a=e.n(n);for(var r in n)"default"!==r&&function(t){e.d(i,t,function(){return n[t]})}(r);i.default=a.a},2073:
/*!******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-1!./node_modules/css-loader??ref--8-oneOf-1-2!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src??ref--8-oneOf-1-3!./node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!./node_modules/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./src/plugins/bargain/activity/activity.vue?vue&type=style&index=0&id=779c3b9a&scoped=true&lang=scss& ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(t,i,e){}},[[2066,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../../.sourcemap/mp-weixin/plugins/bargain/activity/activity.js.map