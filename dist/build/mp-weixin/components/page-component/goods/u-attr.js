(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/page-component/goods/u-attr"],{3195:function(t,e,i){"use strict";var n=i("a182"),o=i.n(n);o.a},5610:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i("2f62"),o=r(i("1639"));function r(t){return t&&t.__esModule?t:{default:t}}function s(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)}return i}function c(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?s(i,!0).forEach(function(e){u(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):s(i).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function u(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var a=function(){return i.e("components/basic-component/u-popup/u-popup").then(i.bind(null,"d55a"))},h=function(){return i.e("components/page-component/goods/app-price").then(i.bind(null,"6c9f9"))},l=function(){return i.e("components/page-component/app-member-mark/app-member-mark").then(i.bind(null,"1ed7"))},d=function(){return i.e("components/page-component/goods/app-sell-tip").then(i.bind(null,"571a"))},p={name:"u-attr",mixins:[o.default],props:{value:{type:[Boolean,Number]},goods:{type:Object,default:function(){return{}},required:!0},theme:{type:Object},checked:{type:Object},is_show_price:{type:Boolean,default:!0},is_show_left:{type:Boolean,default:!0},is_must_left:{type:Boolean,default:!1},is_show_right:{type:Boolean,default:!0},is_choose_number:{type:Boolean,default:!0},leftText:{type:String,default:"加入购物车"},rightText:{type:String,default:"立即购买"},leftFunc:{type:Boolean},rightFunc:{type:Boolean},sign:{type:String},again:{type:Number},attentionSign:{type:String}},data:function(){return{newValue:!1,picUrl:null,newGroup:[],number:1,sell_time:0}},created:function(){this.number=1},methods:{close:function(){this.$emit("input",!1)},turnOn:function(){this.$emit("input",!0)},inArray:function(t,e){return e.some(function(e){return t===e})},identifier:function(t,e,i){var n=this;t.forEach(function(t){t.attr_list.forEach(function(o){var r="".concat(t.attr_group_id,"-").concat(o.attr_id);n.inArray(r,e)&&!n.inArray(r,i)?o.num_0=!0:o.num_0=!1})})},selectCheck:function(t,e,i){var n=this;t.forEach(function(t){var o=[],r=0;t.attr_list.forEach(function(t){var e="".concat(t.attr_group_id,"-").concat(t.attr_id);n.inArray(e,i)||(r+=1,o.push(e))}),0===t.stock&&r<=1&&Array.prototype.push.apply(e,o),0===r&&n.$emit("check",{item:t,number:1})})},storeAttr:function(t,e,i){var n=this;if(!0!==i){var o=this.newGroup,r=this.copyAttr,s=[];o.forEach(function(i,o){var r=i.attr_list;r.forEach(function(r){i.attr_group_id===e&&(r.attr_id===t?!0===r.select?r.select=!1:r.select=!0:r.select=!1),!0===r.select&&(s.push("".concat(i.attr_group_id,"-").concat(r.attr_id)),0===o&&(n.picUrl=r.pic_url))})});var c=[];this.selectCheck(r,c,s),this.$nextTick(function(){n.number>n.stock&&(n.number=n.stock)}),this.identifier(o,c,s),s.length!==o.length&&this.$emit("check",{item:null,number:1})}},firstSelect:function(){var t=this;if(this.copyGroup&&this.copyAttr){var e=this.copyGroup,i=this.copyAttr,n=e.length,o=[];i.forEach(function(i){var r=i.attr_list;r.forEach(function(r){var s=r.attr_group_id;e.forEach(function(c){if(s===c.attr_group_id){var u=c.attr_list;u.forEach(function(s){s.attr_id===r.attr_id&&i.stock>0&&n>0&&(s.select=!0,o.push("".concat(c.attr_group_id,"-").concat(s.attr_id)),n===e.length&&(t.picUrl=s.pic_url),n--)})}})})});var r=[];this.selectCheck(i,r,o),this.identifier(e,r,o),this.newGroup=e}},numberBlur:function(e){var i=parseInt(e.detail.value);i||(i=1),i>this.stock&&(i=this.stock,t.showToast({title:"库存不足",icon:"none"})),this.number=i},numberSub:function(){var t=this.number;t>1&&(t--,this.number=t)},numberAdd:function(){var e=this.number;e++,e>this.stock&&(e=this.stock,t.showToast({title:"库存不足",icon:"none"})),this.checkLimitBuy(e)||(e=this.goods.limit_buy.rest_number),this.number=e},leftSubmit:function(){!0===this.leftFunc?this.$emit("leftFunc",this.number):this.cart(),this.close()},rightSubmit:function(){if(!this.checked)return t.showToast({title:"请先选规格",icon:"none"}),!1;if(!this.$user.isLogin())return this.$user.getInfo();var e=[];this.checked.attr_list.forEach(function(t){e.push({attr_id:t.attr_id,attr_group_id:t.attr_group_id})});var i={mch_id:this.goods.mch_id?this.goods.mch_id:0,goods_list:[{id:this.goods.id,attrs:e,num:this.number,cat_id:0,goods_attr_id:this.checked.id}]};this.checkMinNUmber()&&this.checkLimitBuy(this.number)&&(!0===this.rightFunc?this.$emit("rightFunc",i):this.shop(i),this.close())},shop:function(e){t.navigateTo({url:"/pages/order-submit/order-submit?mch_list=".concat(JSON.stringify([e]))})},cart:function(){var e=this;if(!this.checked)return t.showToast({title:"请先选规格",icon:"none"}),!1;"ecard"!==this.goods.type&&this.$request({url:this.$api.cart.add,method:"post",data:{goods_id:this.checked.goods_id,attr:this.checked.id,num:this.number}}).then(function(i){0===i.code?(t.showToast({title:i.msg,icon:"none"}),e.$emit("cart",e.checked,e.number),e.close()):t.showToast({title:i.msg,icon:"none",duration:2500})})},clickImg:function(e){t.previewImage({current:0,urls:[e]})},checkMinNUmber:function(){return!(this.goods.min_number>this.number)||(this.$tips.showToast({title:"该商品"+this.goods.min_number+this.goods.unit+"起售",icon:"none"}),!1)},checkLimitBuy:function(t){return!("undefined"!==typeof this.goods.limit_buy&&1==this.goods.limit_buy.status&&this.goods.limit_buy.rest_number<t)||(this.$tips.showToast({title:this.goods.limit_buy.text,icon:"none"}),!1)},changeTime:function(t){this.sell_time=t}},components:{uPopup:a,appPrice:h,appMemberMark:l,appSellTip:d},computed:c({imgUrl:function(){return this.picUrl?this.picUrl:this.goods?this.goods.cover_pic:""},stock:function(){return this.$validation.isEmpty(this.checked)?this.$validation.isEmpty(this.goods)?void 0:this.goods.goods_num:this.checked.stock},sellPrice:function(){return this.$validation.isEmpty(this.checked)?this.$validation.isEmpty(this.goods)?void 0:this.goods.hasOwnProperty("price_min")?this.goods.price_min:this.goods.price:1===this.goods.level_show?this.checked.price_member:this.checked.price},copyGroup:function(){if(this.goods){console.log(this.goods.attr_groups);var t=this.$utils.deepClone(this.goods.attr_groups);console.log(t);for(var e=0;e<t.length;e++)t[e].attr_list.forEach(function(t){t.select=!1,t.num_0=!1});return t}},copyAttr:function(){if(this.goods)return this.$utils.deepClone(this.goods.attr)}},(0,n.mapGetters)({userInfo:"user/info"}),{},(0,n.mapState)({isTip:function(t){return t.mallConfig.mall.setting.is_remind_sell_time}}),{remindParams:function(){return{sell_time:this.sell_time,goods_id:this.goods.id,template_message_list:this.goods.template_message_list,buy_text:this.rightText}}}),watch:{value:{handler:function(t){this.newValue=t,!1!==t?(this.sell_time=this.goods.sell_time,this.$validation.isEmpty(this.checked)&&this.$utils.throttle(this.firstSelect,800)):this.number=1},immediate:!0},number:{handler:function(t){this.$emit("check",{item:this.checked,number:t})}},again:{handler:function(){this.firstSelect()}}}};e.default=p}).call(this,i("543d")["default"])},"58c5":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement;t._self._c},o=[];i.d(e,"a",function(){return n}),i.d(e,"b",function(){return o})},a182:function(t,e,i){},b4bc:function(t,e,i){"use strict";i.r(e);var n=i("58c5"),o=i("f066");for(var r in o)"default"!==r&&function(t){i.d(e,t,function(){return o[t]})}(r);i("3195");var s=i("2877"),c=Object(s["a"])(o["default"],n["a"],n["b"],!1,null,"7205c4d2",null);e["default"]=c.exports},f066:function(t,e,i){"use strict";i.r(e);var n=i("5610"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);e["default"]=o.a}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/page-component/goods/u-attr-create-component',
    {
        'components/page-component/goods/u-attr-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("b4bc"))
        })
    },
    [['components/page-component/goods/u-attr-create-component']]
]);                
