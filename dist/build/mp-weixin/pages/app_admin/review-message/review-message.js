(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/app_admin/review-message/review-message"],{"260f":function(t,e,i){"use strict";i.r(e);var r=i("807b"),n=i.n(r);for(var o in r)"default"!==o&&function(t){i.d(e,t,function(){return r[t]})}(o);e["default"]=n.a},2643:function(t,e,i){"use strict";var r=function(){var t=this,e=t.$createElement,i=(t._self._c,t.__map(t.form,function(e,i){var r=Array.isArray(e.value);return{$orig:t.__get_orig(e),g0:r}}));t._isMounted||(t.e0=function(e){t.searchBool=!0,t.getFocus=!0},t.e1=function(e){t.getFocus=!0},t.e2=function(e){t.getFocus=!1}),t.$mp.data=Object.assign({},{$root:{l0:i}})},n=[];i.d(e,"a",function(){return r}),i.d(e,"b",function(){return n})},4732:function(t,e,i){"use strict";i.r(e);var r=i("2643"),n=i("260f");for(var o in n)"default"!==o&&function(t){i.d(e,t,function(){return n[t]})}(o);i("7c70");var s=i("2877"),a=Object(s["a"])(n["default"],r["a"],r["b"],!1,null,"2cfb3c48",null);e["default"]=a.exports},"7c70":function(t,e,i){"use strict";var r=i("a419"),n=i.n(r);n.a},"807b":function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=o(i("a34a")),n=i("2f62");function o(t){return t&&t.__esModule?t:{default:t}}function s(t,e,i,r,n,o,s){try{var a=t[o](s),u=a.value}catch(h){return void i(h)}a.done?e(u):Promise.resolve(u).then(r,n)}function a(t){return function(){var e=this,i=arguments;return new Promise(function(r,n){var o=t.apply(e,i);function a(t){s(o,r,n,a,u,"next",t)}function u(t){s(o,r,n,a,u,"throw",t)}a(void 0)})}}function u(t){return l(t)||c(t)||h()}function h(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function c(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function l(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}function f(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function d(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?f(i,!0).forEach(function(e){p(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):f(i).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function p(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var m={name:"review-message",data:function(){return{type:"share",first:!0,over:!1,titleShow:!1,showForm:!1,form:[],list:[],tab:[],getFocus:!1,keyword:"",searchBool:!1,modelType:1,reasonRefusal:"",setItem:{},titleWidth:"100%",model:!1,page:1}},computed:d({},(0,n.mapState)({windowHeight:function(t){return t.gConfig.systemInfo.windowHeight}})),onLoad:function(){this.$commonLoad.onload(),this.$showLoading({type:"global",text:"加载中..."}),this.getTabs()},onShow:function(){var t=this;if(this.first)return!1;this.request({key:this.type,page:1,keyword:this.keyword}).then(function(e){e&&(t.list=e.list)})},methods:{getMore:function(){var t=this;this.over||(this.page++,this.request({key:this.type,page:this.page,keyword:this.keyword}).then(function(e){e&&e.list.length>0?t.list=[].concat(u(t.list),u(e.list)):e&&0===e.list.length&&(t.over=!0)}))},imageLoad:function(t){this.form[t].loadOver=!1},look:function(e){t.previewImage({current:e,urls:[e]})},toggle:function(t){for(var e in this.form=t.form,this.form)if("img_upload"==this.form[e].key&&Array.isArray(this.form[e].value)){var i=!1,r=!0,n=!1,o=void 0;try{for(var s,a=this.form[e].value[Symbol.iterator]();!(r=(s=a.next()).done);r=!0){var u=s.value;""!=u&&(i=!0)}}catch(h){n=!0,o=h}finally{try{r||null==a.return||a.return()}finally{if(n)throw o}}i||this.form.splice(e,1)}this.showForm=!0},toUrl:function(e){if("region"==this.type||"community"==this.type||"mch"==this.type){var i="/pages/app_admin/"+this.type+"-detail/"+this.type+"-detail?id=";"region"==this.type&&(i+=e.id+"&name="+e.nickname),"mch"==this.type&&(i+=e.id),"community"==this.type&&(i+=e.user_id),t.navigateTo({url:i})}},tabSwitch:function(e){var i=this;this.list=[],this.type=e,t.showLoading({mask:!0,title:"加载中..."}),this.request({key:e,page:1,keyword:""}).then(function(e){t.hideLoading(),e&&(i.list=e.list)})},getTabs:function(){var e=this,i=this;i.$request({url:i.$api.app_admin.tabs_v2,method:"get"}).then(function(r){i.$hideLoading(),t.hideLoading(),0==r.code?(i.tab=r.data,1==i.tab.length?t.setNavigationBarTitle({title:i.tab[0].plugin+"审核消息"}):i.titleShow=!0,i.titleWidth=1/i.tab.length*100+"%",i.type=r.data[0].key,i.request({key:r.data[0].key,page:1,keyword:""}).then(function(t){e.first=!1,t&&(i.list=t.list)})):t.showToast({title:r.msg,icon:"none",duration:1e3})})},blurFocus:function(){var t=this;setTimeout(function(e){t.getFocus=!1,t.searchText()},300)},clearSearch:function(){this.keyword="",this.searchBool=!1,this.searchBool||this.searchText()},changeType:function(t){var e=this;this.list=[],this.page=1,this.type=t,this.over=!1,this.keyword="",this.searchBool=!1,this.request({key:t,page:this.page,keyword:this.keyword}).then(function(t){t&&(e.list=t.list)})},request:function(){var e=a(r.default.mark(function e(i){var n,o,s,a;return r.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=i.key,o=i.page,s=i.keyword,e.next=3,this.$request({url:this.$api.app_admin.review_v2,data:{key:n,page:o,keyword:s}});case 3:if(a=e.sent,0!==a.code){e.next=8;break}return e.abrupt("return",a.data);case 8:return t.showToast({title:a.msg,icon:"none",duration:1e3}),e.abrupt("return",!1);case 10:case"end":return e.stop()}},e,this)}));function i(t){return e.apply(this,arguments)}return i}(),checkQueue:function(t){var e=this;this.$request({url:this.$api.app_admin.queue,data:{queue_id:t}}).then(function(i){if(i.retry&&1==i.retry)e.checkQueue(t);else for(var r=0;r<e.list.length;r++)e.list[r].id===e.setItem.id&&(e.$delete(e.list,r),e.model=!1,e.setItem={})})},searchText:function(){var e=this;""===this.keyword&&(this.searchBool=!1),this.page=1,this.over=!1,t.showLoading({mask:!0,title:"搜索中..."}),this.request({key:this.type,page:this.page,keyword:this.keyword}).then(function(i){t.hideLoading(),i&&(e.list=i.list)})},refuse:function(t){this.setItem=t,this.modelType=1,this.model=!0},by:function(t){this.setItem=t,this.modelType=2,this.model=!0},confirm:function(){var e=this;2===this.modelType?this.$request({url:this.$api.app_admin.review_switch_v2,method:"post",data:{key:this.type,status:1,form:JSON.stringify(this.setItem),user_id:this.setItem.user_id}}).then(function(t){if(0===t.code)if(3==e.type)e.checkQueue(t.data.queue_id);else for(var i=0;i<e.list.length;i++)e.list[i].id===e.setItem.id&&(e.$delete(e.list,i),e.model=!1,e.setItem={})}):1===this.modelType&&(this.setItem.review_remark=this.reasonRefusal,this.$request({url:this.$api.app_admin.review_switch_v2,method:"post",data:{key:this.type,status:2,form:JSON.stringify(this.setItem),reason:this.reasonRefusal,user_id:this.setItem.user_id}}).then(function(i){if(0===i.code){e.reasonRefusal="";for(var r=0;r<e.list.length;r++)e.list[r].id===e.setItem.id&&(e.$delete(e.list,r),e.model=!1,e.setItem={})}else t.showToast({title:i.msg,icon:"none",duration:1e3})}))},cancel:function(){this.model=!1,this.form=[],this.showForm=!1,this.setItem={}}}};e.default=m}).call(this,i("543d")["default"])},a419:function(t,e,i){}},[["8afb","common/runtime","common/vendor"]]]);