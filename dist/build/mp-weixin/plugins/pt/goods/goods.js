(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["plugins/pt/goods/goods"],{"1d92":function(t,e,i){"use strict";i.r(e);var n=i("f039"),o=i("33a2");for(var s in o)"default"!==s&&function(t){i.d(e,t,function(){return o[t]})}(s);i("90a9");var r=i("2877"),a=Object(r["a"])(o["default"],n["a"],n["b"],!1,null,"3523c8cc",null);e["default"]=a.exports},"33a2":function(t,e,i){"use strict";i.r(e);var n=i("ccc0"),o=i.n(n);for(var s in n)"default"!==s&&function(t){i.d(e,t,function(){return n[t]})}(s);e["default"]=o.a},"8d40":function(t,e,i){},"90a9":function(t,e,i){"use strict";var n=i("8d40"),o=i.n(n);o.a},ae58:function(t,e){t.exports=require("../siteinfo.js")},ccc0:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(i("a34a")),o=i("2f62");function s(t){return t&&t.__esModule?t:{default:t}}function r(t,e,i,n,o,s,r){try{var a=t[s](r),u=a.value}catch(c){return void i(c)}a.done?e(u):Promise.resolve(u).then(n,o)}function a(t){return function(){var e=this,i=arguments;return new Promise(function(n,o){var s=t.apply(e,i);function a(t){r(s,n,o,a,u,"next",t)}function u(t){r(s,n,o,a,u,"throw",t)}a(void 0)})}}function u(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)}return i}function c(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?u(i,!0).forEach(function(e){p(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):u(i).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function p(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var d=function(){return i.e("components/page-component/goods/app-goods-banner").then(i.bind(null,"12b6"))},l=function(){return i.e("plugins/pt/components/app-pt-time").then(i.bind(null,"c357"))},h=function(){return i.e("plugins/pt/components/app-merchant-guarantee").then(i.bind(null,"1bf1"))},m=function(){return i.e("plugins/pt/components/app-buttom-button").then(i.bind(null,"e20b"))},_=function(){return i.e("plugins/pt/components/app-pt-attr").then(i.bind(null,"3556"))},g=function(){return i.e("plugins/pt/components/app-participant").then(i.bind(null,"d49f"))},f=function(){return i.e("components/page-component/app-related-suggestion-product/app-related-suggestion-product").then(i.bind(null,"1ce4"))},b=function(){return i.e("components/page-component/app-quick-navigation/app-quick-navigation").then(i.bind(null,"4d92"))},v=function(){return i.e("components/page-component/goods/app-goods-full-reduce").then(i.bind(null,"6132"))},w=function(){return Promise.all([i.e("common/vendor"),i.e("components/page-component/goods/u-attr")]).then(i.bind(null,"b4bc"))},$=function(){return i.e("components/page-component/goods/bd-info").then(i.bind(null,"0e01"))},A=function(){return Promise.all([i.e("common/vendor"),i.e("components/page-component/goods/bd-coupon")]).then(i.bind(null,"11b2"))},y=function(){return i.e("components/page-component/goods/bd-xbc").then(i.bind(null,"8639"))},T=function(){return i.e("components/page-component/goods/bd-kb").then(i.bind(null,"4c29"))},I=function(){return i.e("components/page-component/goods/bd-hc").then(i.bind(null,"de37"))},O=function(){return i.e("components/page-component/goods/bd-detail").then(i.bind(null,"3e70"))},x=function(){return i.e("components/page-component/goods/bd-comments").then(i.bind(null,"9470"))},P=function(){return i.e("components/basic-component/app-close/app-close").then(i.bind(null,"f0dd"))},S={name:"goods",data:function(){return{showClose:!1,is_open:0,goods_id:0,detail:{goods_activity:{full_reduce:{}},groups:[]},full_reduce:null,loading:!1,share_url:"",time_str:{day:"00",hou:"00",min:"00",sec:"00"},down_time:0,discount:null,isVip:!1,goods:{},item:{name:"",pintuan_groups:[]},selectAttr:null,show:!1,pt:!1,selectGroupAttrId:0,pintuan_list:[],list:[],cartShow:!1,price:"",webUrl:"",time:null,is_vip_card_user:0,url:this.$api.pt.detail,poster_config:this.$api.pt.poster_config,poster_generate:this.$api.pt.poster_generate,aloneAttr:null,start_time:!1,pintuan_list_time:"",pt_time:null,number:1,group_price:"",again:0,flash_sale:null}},computed:c({},(0,o.mapState)("gConfig",{iphone:function(t){return t.iphone},iphoneHeight:function(t){return t.iphoneHeight}}),{},(0,o.mapState)({mall:function(t){return t.mallConfig.mall}}),{},(0,o.mapGetters)("mallConfig",{getTheme:"getTheme"}),{set_group_num:function(){for(var t=0;t<this.detail.groups.length;t++)if(this.detail.groups[t].groups.id==this.selectGroupAttrId)return t},groupPrice:function(){if(!this.$validation.isEmpty(this.selectAttr)){if(this.pt)return 1===this.detail.level_show?0===this.selectAttr.price_member?"免费":"￥".concat(this.selectAttr.price_member):0===Number(this.selectAttr.price)?"免费":"￥".concat(this.selectAttr.price);for(var t=this.detail.groups[this.set_group_num].attr,e=0;e<t.length;e++)if(t[e].sign_id===this.selectAttr.sign_id)return 1===this.detail.level_show?0===t[e].price_member?"免费":"￥".concat(t[e].price_member):0===Number(t[e].price)?"免费":"￥".concat(t[e].price)}},singlePrice:function(){if(this.$validation.isEmpty(this.selectAttr))return 1===this.detail.level_show?0===Number(this.detail.price_member_min)?"免费":"￥".concat(this.detail.price_member_min):0===Number(this.detail.price)?"免费":"￥".concat(this.detail.price);for(var t=0;t<this.aloneAttr.length;t++)if(this.aloneAttr[t].sign_id===this.selectAttr.sign_id)return 1===this.detail.level_show?0===Number(this.aloneAttr[t].price_member)?"免费":"￥".concat(this.aloneAttr[t].price_member):0===Number(this.aloneAttr[t].price)?"免费":"￥".concat(this.aloneAttr[t].price)},groupSparePrice:function(){return this.detail.groups.length>0?(this.detail.original_price-this.detail.groups[0].price_min).toFixed(2):this.detail.original_price}}),onShow:function(){var t=this;this.showClose=!1,setTimeout(function(){t.showClose=!0})},onLoad:function(t){this.$commonLoad.onload(t),this.webUrl="/plugins/pt/goods/goods?goods_id="+t.goods_id,this.goods_id=t.goods_id,this.requestDetail(),this.newRecommend(),wx.showShareMenu({menus:["shareAppMessage","shareTimeline"]})},onShareTimeline:function(){return this.$shareTimeline({title:this.detail.app_share_title?this.detail.app_share_title:this.detail.name,query:{goods_id:this.goods_id}})},onShareAppMessage:function(){return this.hShareAppMessage()},methods:{hShareAppMessage:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.$shareAppMessage({path:"/plugins/pt/goods/goods",title:this.detail.app_share_title?this.detail.app_share_title:this.detail.name,imageUrl:this.detail.app_share_pic?this.detail.app_share_pic:this.detail.pic_url[0].pic_url,desc:this.detail.subtitle,params:{goods_id:this.goods_id}},t)},getMall:function(t){this.is_open=t.is_open},goJoin:function(e){t.navigateTo({url:"/plugins/pt/detail/detail?id=".concat(e)})},requestDetail:function(){var e=a(n.default.mark(function e(){var i,o,s,r,a,u,c,p=this;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$request({url:this.$api.pt.detail,method:"get",data:{id:this.goods_id}});case 2:i=e.sent,0===i.code?(this.loading=!0,o=i.data.detail,this.detail=o,this.price=o.price,this.aloneAttr=JSON.parse(JSON.stringify(o.attr)),s=o.groups,s.length>0&&(this.detail.attr=s[0].attr,this.selectGroupAttrId=s[0].groups.id),o.goods_activity&&(this.full_reduce=o.goods_activity.full_reduce),this.flash_sale=o.plugin_extra.flash_sale,this.share_url="".concat(this.$api.pt.poster,"&goods_id=").concat(this.detail.id),this.poster_config="".concat(this.poster_config,"&goods_id=").concat(this.detail.id),this.poster_generate="".concat(this.poster_generate,"&goods_id=").concat(this.detail.id),this.pintuan_list=i.data.pintuan_list,this.pintuan_list.length>0&&(r=new Date(this.pintuan_list[0].surplus_date_time.replace(/-/g,"/")),this.pt_time=setInterval(function(){var t=r.getTime()-(new Date).getTime();t<0&&clearInterval(p.pt_time);var e=parseInt(t/1e3/60/60/24%30),i=parseInt(t/1e3/60/60%24),n=parseInt(t/1e3/60%60),o=parseInt(t/1e3%60);p.pintuan_list_time=e>0?e+"天"+i+":"+(n<10?"0"+n:n)+":"+(o<10?"0"+o:o):i+":"+(n<10?"0"+n:n)+":"+(o<10?"0"+o:o)},1e3)),o.vip_card_appoint.discount&&(this.isVip=!0,this.discount=o.vip_card_appoint.discount),this.is_vip_card_user=o.vip_card_appoint.is_vip_card_user,this.goods={attr:o.attr,cover_pic:o.cover_pic,level_show:o.level_show,price:o.price,mch_id:o.mch_id,name:o.name,id:o.id},"0000-00-00 00:00:00"!==o.pintuanGoods.end_time&&this.countdown(o.pintuanGoods.end_time),o.pintuanGoods.start_time&&(a=new Date(o.pintuanGoods.start_time.replace(/-/g,"/")),u=new Date,c=a.getTime()-u.getTime(),c>0?(this.start_time=!1,this.countdown(o.pintuanGoods.start_time)):this.start_time=!0)):t.showToast({title:i.msg,icon:"none"});case 4:case"end":return e.stop()}},e,this)}));function i(){return e.apply(this,arguments)}return i}(),countdown:function(t){var e=this,i=new Date(t.replace(/-/g,"/")),n=new Date,o=i.getTime()-n.getTime(),s=parseInt(o/36e5/24),r=parseInt(o/1e3/60/60%24),a=parseInt(o/1e3/60%60),u=parseInt(o/1e3%60);this.time_str={day:s<10?"0".concat(s):s,hou:r<10?"0".concat(r):r,min:a<10?"0".concat(a):a,sec:u<10?"0".concat(u):u},this.down_time=setTimeout(function(){e.countdown(t)},1e3)},newRecommend:function(){var t=a(n.default.mark(function t(){var e;return n.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$request({url:this.$api.goods.new_recommend});case 2:e=t.sent,0===e.code&&(this.list=e.data.list);case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),setCoupon:function(t){this.$set(this.detail.goods_coupon_center[t],"is_receive",1)},attrTap:function(t){for(var e=t.item,i=t.number,n=0;n<this.aloneAttr.length;n++)this.aloneAttr[n].sign_id===e.sign_id&&(this.price=this.aloneAttr[n].price);this.number=i,this.selectAttr=e},shop:function(t){var e=this;this.detail.buy_goods_auth?(!0===t?(this.$set(this,"pt",!0),this.detail.groups.forEach(function(t){e.selectGroupAttrId===t.groups.id&&(e.$set(e.detail,"attr",t.attr),e.$set(e.detail,"id",t.groups.goods_id))})):(this.$set(this,"pt",!1),this.$set(this.detail,"attr",this.aloneAttr),this.$set(this.detail,"id",this.goods_id)),this.show=!0,this.$nextTick(function(){e.again=Math.random()})):this.$tips.showToast({title:"您暂无权限购买该商品",icon:"none"})},setGroupAttrID:function(t){var e=this;this.selectGroupAttrId=t.groups.id,this.$set(this.detail,"attr",t.attr),this.$set(this.detail,"id",t.groups.goods_id),this.$nextTick(function(){e.again=Math.random()})},defaultRequest:function(){this.$set(this,"pt",!0),this.detail.attr=this.detail.groups[0].attr,this.selectGroupAttrId=this.detail.groups[0].groups.id,this.detail.id=this.detail.groups[0].groups.goods_id},rightFunc:function(){var e=this;if(!1===this.pt&&!0===this.show)this.pt=!0,this.$set(this,"pt",!0),setTimeout(function(){e.show=!0},500),this.detail.groups.forEach(function(t){e.selectGroupAttrId===t.groups.id&&(e.$set(e.detail,"attr",t.attr),e.$set(e.detail,"id",t.groups.goods_id))}),this.$nextTick(function(){e.again=Math.random()});else{if(this.detail.min_number>this.number)return this.$tips.showToast({title:"该商品"+this.detail.min_number+this.detail.unit+"起售",icon:"none"}),!1;if("undefined"!==typeof this.detail.limit_buy&&1==this.detail.limit_buy.status&&this.detail.limit_buy.rest_number<this.number)return this.$tips.showToast({title:this.detail.limit_buy.text,icon:"none"}),!1;var i=[];this.selectAttr.attr_list.forEach(function(t){i.push({attr_id:t.attr_id,attr_group_id:t.attr_group_id})});var n={pintuan_order_id:0,pintuan_group_id:this.selectGroupAttrId,mch_id:this.detail.mch_id?this.detail.mch_id:0,goods_list:[{id:this.detail.id,attrs:i,num:this.number,cat_id:0,goods_attr_id:this.selectAttr.id}]};t.navigateTo({url:"/pages/order-submit/order-submit?mch_list=".concat(JSON.stringify([n]),"&preview_url=").concat(encodeURIComponent(this.$api.pt.order_preview),"&submit_url=").concat(encodeURIComponent(this.$api.pt.order_submit))})}},leftFunc:function(e){var i=this;if(!0===this.pt&&!0===this.show)this.$set(this,"pt",!1),setTimeout(function(){i.show=!0},500),this.$set(this.detail,"attr",this.aloneAttr),this.$set(this.detail,"id",this.goods_id),this.$nextTick(function(){i.$refs.attr.firstSelect()});else{if(this.detail.min_number>this.number)return this.$tips.showToast({title:"该商品"+this.detail.min_number+this.detail.unit+"起售",icon:"none"}),!1;if("undefined"!==typeof this.detail.limit_buy&&1==this.detail.limit_buy.status&&this.detail.limit_buy.rest_number<this.number)return this.$tips.showToast({title:this.detail.limit_buy.text,icon:"none"}),!1;var n=this.detail,o=this.selectAttr,s=[];for(var r in o.attr_list)s.push({attr_id:o.attr_list[r].attr_id,attr_group_id:o.attr_list[r].attr_group_id});var a=[{mch_id:n.mch_id?n.mch_id:0,pintuan_order_id:0,pintuan_group_id:0,goods_list:[{id:n.id,attr:s,num:e,cat_id:0,goods_attr_id:o.id}]}];t.navigateTo({url:"/pages/order-submit/order-submit?mch_list=".concat(JSON.stringify(a),"&preview_url=").concat(encodeURIComponent(this.$api.pt.order_preview),"&submit_url=").concat(encodeURIComponent(this.$api.pt.order_submit))})}}},components:{bdInfo:$,bdCoupon:A,bdXbc:y,bdKb:T,bdHc:I,bdDetail:O,bdComments:x,"app-goods-banner":d,"app-pt-time":l,"app-merchant-guarantee":h,"app-button-button":m,"app-pt-attr":_,"app-participant":g,"app-related-suggestion-product":f,"app-quick-navigation":b,uAttr:w,appGoodsFullReduce:v,appClose:P},onHide:function(){clearTimeout(this.down_time)},onUnload:function(){clearTimeout(this.down_time)}};e.default=S}).call(this,i("543d")["default"])},f039:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement;t._self._c},o=[];i.d(e,"a",function(){return n}),i.d(e,"b",function(){return o})}},[["b954","common/runtime","common/vendor"]]]);