(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["plugins/wholesale/goods/goods"],{"0676":function(t,e,o){"use strict";var n=o("c6f9"),r=o.n(n);r.a},"1cdf":function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=(t._self._c,encodeURIComponent(t.mall.setting.web_service_url));t.$mp.data=Object.assign({},{$root:{m0:o}})},r=[];o.d(e,"a",function(){return n}),o.d(e,"b",function(){return r})},"45f7":function(t,e,o){"use strict";o.r(e);var n=o("1cdf"),r=o("e793");for(var i in r)"default"!==i&&function(t){o.d(e,t,function(){return r[t]})}(i);o("0676");var a=o("2877"),s=Object(a["a"])(r["default"],n["a"],n["b"],!1,null,"73bc52b2",null);e["default"]=s.exports},"8ecf":function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(o("a34a")),r=o("2f62"),i=a(o("1639"));function a(t){return t&&t.__esModule?t:{default:t}}function s(t,e,o,n,r,i,a){try{var s=t[i](a),l=s.value}catch(c){return void o(c)}s.done?e(l):Promise.resolve(l).then(n,r)}function l(t){return function(){var e=this,o=arguments;return new Promise(function(n,r){var i=t.apply(e,o);function a(t){s(i,n,r,a,l,"next",t)}function l(t){s(i,n,r,a,l,"throw",t)}a(void 0)})}}function c(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,n)}return o}function u(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?c(o,!0).forEach(function(e){d(t,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):c(o).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))})}return t}function d(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var h=function(){return o.e("components/page-component/goods/app-goods-banner").then(o.bind(null,"12b6"))},g=function(){return o.e("plugins/wholesale/components/app-attr/app-attr").then(o.bind(null,"3e8e"))},p=function(){return o.e("components/page-component/goods/app-goods-full-reduce").then(o.bind(null,"6132"))},f=function(){return o.e("components/page-component/goods/bd-info").then(o.bind(null,"0e01"))},b=function(){return Promise.all([o.e("common/vendor"),o.e("components/page-component/goods/bd-coupon")]).then(o.bind(null,"11b2"))},_=function(){return o.e("components/page-component/goods/bd-xbc").then(o.bind(null,"8639"))},m=function(){return o.e("components/page-component/goods/bd-kb").then(o.bind(null,"4c29"))},v=function(){return o.e("components/page-component/goods/bd-hc").then(o.bind(null,"de37"))},w=function(){return o.e("components/page-component/goods/bd-detail").then(o.bind(null,"3e70"))},y=function(){return o.e("components/page-component/goods/bd-comments").then(o.bind(null,"9470"))},T=function(){return o.e("components/basic-component/app-close/app-close").then(o.bind(null,"f0dd"))},x=function(){return o.e("components/page-component/goods/bd-service").then(o.bind(null,"861b"))},k=function(){return o.e("components/page-component/goods/app-sell-tip").then(o.bind(null,"571a"))},S={name:"goods",mixins:[i.default],data:function(){return{showClose:!1,is_open:0,goods:{id:"",name:"",cover_pic:"",price:"",section:[],wholesaleGoods:{rise_num:0}},selectAttr:{attr_list:[]},webUrl:"",previewUrl:this.$api.wholesale.order_preview,submitUrl:this.$api.wholesale.order_submit,show:0,list:[],appAttr:{},totalNumber:0,totalPrice:"0.00",poster_config:this.$api.wholesale.poster_config,poster_generate:this.$api.wholesale.poster_generate,url:this.$api.wholesale.poster,goods_id:-1,loading:!1,first:!0,is_vip:!1,is_vip_card_user:0,discount:null,full_reduce:null,flash_sale:null,wholesaleDiscount:0}},onLoad:function(t){var e=this;this.$commonLoad.onload(t);var o=this;o.goods_id=t.id,o.webUrl="/plugins/wholesale/goods/goods?id="+t.id,wx.showShareMenu({menus:["shareAppMessage","shareTimeline"]}),o.$showLoading({type:"global",text:"加载中..."}),o.request({url:o.$api.wholesale.detail,data:{id:o.goods_id}}).then(function(t){o.first=!1,o.goods=t.detail,t.detail.goods_activity&&(e.full_reduce=t.detail.goods_activity.full_reduce),o.goods.vip_card_appoint.discount>0&&(o.is_vip=!0,o.discount=o.goods.vip_card_appoint.discount),o.is_vip_card_user=o.goods.vip_card_appoint.is_vip_card_user;var n=!0,r=!1,i=void 0;try{for(var a,s=o.goods.attr[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var l=a.value;l.number="0"}}catch(b){r=!0,i=b}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}if(1==o.goods.attr_groups.length)o.goods.attr[0].number="0";else{var c=!0,u=!1,d=void 0;try{for(var h,g=o.goods.attr_groups[Symbol.iterator]();!(c=(h=g.next()).done);c=!0){var p=h.value;for(var f in p.less_attr_group_name=p.attr_group_name.substring(0,10),p.scrollLeft=0,p.attr_list)p.attr_list[f].active=!(f>0),p.attr_list[f].number=0}}catch(b){u=!0,d=b}finally{try{c||null==g.return||g.return()}finally{if(u)throw d}}}o.flash_sale=o.goods.plugin_extra.flash_sale,o.loading=!0,o.$hideLoading()})},onShow:function(){var t=this;if(this.showClose=!1,setTimeout(function(){t.showClose=!0}),this.first)return!1;var e=JSON.parse(JSON.stringify(this.goods.attr)),o=JSON.parse(JSON.stringify(this.goods.attr_groups));this.$showLoading(),this.$nextTick(function(){var n=t;n.request({url:n.$api.wholesale.detail,data:{id:n.goods_id}}).then(function(r){n.goods=r.detail,n.goods.attr=e,n.goods.attr_groups=o,t.$hideLoading()})})},computed:u({},(0,r.mapState)({isTip:function(t){return t.mallConfig.mall.setting.is_remind_sell_time},mall:function(t){return t.mallConfig.mall}}),{},(0,r.mapGetters)("mallConfig",{getTheme:"getTheme"}),{good_negotiable:function(){var t=this.mall.setting.good_negotiable;this.contact_tel="",this.contact="",this.contact_web="";for(var e=[],o=0;o<t.length;o++)"contact_tel"===t[o]&&(this.contact_tel="contact_tel"),"contact"===t[o]&&(this.contact="contact"),"contact_web"===t[o]&&(this.contact_web="contact_web");return this.contact_tel&&e.push(this.contact_tel),this.contact&&e.push(this.contact),this.contact_web&&e.push(this.contact_web),e},contactBtnStyle:function(){var t=this.good_negotiable.length,e=this.getTheme.key;return 3!==t||"a"!==e&&"b"!==e&&"f"!==e?3===t&&"a"!==e&&"b"!==e&&"f"!==e?"background:".concat(this.getTheme.background_gradient_btn,";color:").concat(this.getTheme.color,";"):2!==t||"a"!==e&&"b"!==e&&"f"!==e||this.contact_tel?2!==t||"a"!==e&&"b"!==e&&"f"!==e||!this.contact_tel?2!==t||"a"===e||"b"===e||"f"===e||this.contact_tel?2===t&&"a"!==e&&"b"!==e&&"f"!==e&&this.contact_tel?"background:".concat(this.getTheme.background_gradient_btn,";color:").concat(this.getTheme.color):"background:".concat(this.getTheme.background_gradient_btn):"background:".concat(this.getTheme.background_s_gradient_btn,";color:").concat(this.getTheme.color):"background:".concat(this.getTheme.background_gradient_btn):"background:".concat(this.getTheme.background_s_gradient_btn):"background:".concat(this.getTheme.background_gradient_btn)},contactBtn:function(){var t=this.good_negotiable.length,e=this.getTheme.key;return 3!==t||"a"!==e&&"b"!==e&&"f"!==e?3===t&&"a"!==e&&"b"!==e&&"f"!==e?"bd-three-one bd-no-radius ":2!==t||"a"!==e&&"b"!==e&&"f"!==e||this.contact_tel?2!==t||"a"!==e&&"b"!==e&&"f"!==e||!this.contact_tel?2!==t||"a"===e||"b"===e||"f"===e||this.contact_tel?2===t&&"a"!==e&&"b"!==e&&"f"!==e&&this.contact_tel?"bd-btn-half bd-content-radius-1":"text  all-width all-radius ":"bd-btn-half bd-content-radius-0":"text bd-btn-half bd-content-radius-1":"text bd-btn-half bd-content-radius-0":"text bd-three-one bd-no-radius "},uBottomHeight:function(){return this.full_reduce&&this.goods.sell_time>0?"u-bottom-height-2":this.full_reduce||this.goods.sell_time>0?"u-bottom-height-1":"u-bottom-height-0"},leftTip:function(){var t="";return t=0==this.isTip&&this.goods.sell_time>0?"box-grow-1":"bd-btn-left bd-btn-half",this.goods&&"goods"===this.goods.type?t:""},disableBtn:function(){return this.goods.is_finish_sell?"btn-finish-sell":"bd-oversell-btn"},showRight:function(){return!(0==this.isTip&&this.goods.sell_time>0)},remindParams:function(){return{sell_time:this.goods.sell_time,goods_id:this.goods.id,template_message_list:this.goods.template_message_list,buy_text:"立即购买"}}}),onShareTimeline:function(){return this.$shareTimeline({title:this.goods.app_share_title?this.goods.app_share_title:this.goods.name,imageUrl:this.goods.pic_url[0].pic_url,query:{id:this.goods.id}})},onShareAppMessage:function(){return this.hShareAppMessage()},methods:{hShareAppMessage:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.$shareAppMessage({path:"/plugins/wholesale/goods/goods",title:this.goods.app_share_title?this.goods.app_share_title:this.goods.name,imageUrl:this.goods.app_share_pic?this.goods.app_share_pic:this.goods.pic_url[0].pic_url,desc:this.goods.subtitle,params:{id:this.goods.id}},t)},getMall:function(t){this.is_open=t.is_open},setCoupon:function(t){this.$set(this.goods.goods_coupon_center[t],"is_receive",1)},clickAttr:function(t){1===t&&this.goods.sell_time>0?this.rightTip():this.show=Math.random()},attr:function(t){this.appAttr=t},favorite:function(){var e=this.$api.user.favorite_add,o=!0;this.goods.favorite&&(e=this.$api.user.favorite_remove,o=!1),this.goods.favorite=o,this.$request({url:e,data:{goods_id:this.goods.id}}).then(function(e){0===e.code||t.showModal({title:"提示",content:e.msg,showCancel:!1})}).catch(function(t){})},back:function(){t.reLaunch({url:"/pages/index/index"})},request:function(){var e=l(n.default.mark(function e(o){var r,i,a;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=o.url,i=o.data,e.next=3,this.$request({url:r,data:i});case 3:if(a=e.sent,0!==a.code){e.next=8;break}return e.abrupt("return",a.data);case 8:t.showToast({title:a.msg,icon:"none",duration:1e3}),setTimeout(function(){t.navigateBack()},1e3);case 10:case"end":return e.stop()}},e,this)}));function o(t){return e.apply(this,arguments)}return o}(),attrtap:function(t){var e=this,o=this;if(null!==t.goods){if(o.goods=t.goods,t.goodsAttr&&"undefined"!==t.goodsAttr){var n=!0,r=!1,i=void 0;try{for(var a,s=t.goodsAttr[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var l=a.value,c=!0,u=!1,d=void 0;try{for(var h,g=o.goods.attr[Symbol.iterator]();!(c=(h=g.next()).done);c=!0){var p=h.value;l.id==p.id&&(p.number=l.number)}}catch(L){u=!0,d=L}finally{try{c||null==g.return||g.return()}finally{if(u)throw d}}}}catch(L){r=!0,i=L}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}}o.totalNumber=0;var f=0,b=!0,_=!1,m=void 0;try{for(var v,w=o.goods.attr[Symbol.iterator]();!(b=(v=w.next()).done);b=!0){var y=v.value;if(o.totalNumber+=+y.number,y.number>0){var T=1===o.goods.level_show?y.price_member:y.price;f+=y.number*T}}}catch(L){_=!0,m=L}finally{try{b||null==w.return||w.return()}finally{if(_)throw m}}if(o.goods.attr_groups.length>1){var x=!0,k=!1,S=void 0;try{for(var O,$=o.goods.attr_groups[0].attr_list[Symbol.iterator]();!(x=(O=$.next()).done);x=!0){var P=O.value;P.number=0;var j=!0,C=!1,A=void 0;try{for(var D,M=o.goods.attr[Symbol.iterator]();!(j=(D=M.next()).done);j=!0){var N=D.value;N.number>0&&P.attr_id==N.attr_list[0].attr_id&&P.attr_name==N.attr_list[0].attr_name&&(P.number+=+N.number,P.length=-5-10*+P.number.toString().length)}}catch(L){C=!0,A=L}finally{try{j||null==M.return||M.return()}finally{if(C)throw A}}}}catch(L){k=!0,S=L}finally{try{x||null==$.return||$.return()}finally{if(k)throw S}}}setTimeout(function(){var t=0,n=!0,r=!1,i=void 0;try{for(var a,s=o.goods.wholesaleGoods.wholesale_rules[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var l=a.value;o.totalNumber<l.num||(e.wholesaleDiscount=+l.discount,t++)}}catch(L){r=!0,i=L}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}0==t&&(e.wholesaleDiscount=0==o.goods.wholesaleGoods.type?10:0),e.wholesaleDiscount>0&&(0==o.goods.wholesaleGoods.type?f*=e.wholesaleDiscount/10:f-=e.wholesaleDiscount*o.totalNumber),o.totalPrice=f.toFixed(2)},0)}},makePhoneCall:function(e){t.makePhoneCall({phoneNumber:e})},router:function(e){t.navigateTo({url:e})},changeTime:function(t){this.goods.sell_time=t}},components:{"app-banner":h,"app-attr":g,"app-goods-full-reduce":p,appClose:T,bdInfo:f,bdCoupon:b,bdXbc:_,bdKb:m,bdHc:v,bdDetail:w,bdComments:y,bdService:x,appSellTip:k}};e.default=S}).call(this,o("543d")["default"])},ae58:function(t,e){t.exports=require("../siteinfo.js")},c6f9:function(t,e,o){},e793:function(t,e,o){"use strict";o.r(e);var n=o("8ecf"),r=o.n(n);for(var i in n)"default"!==i&&function(t){o.d(e,t,function(){return n[t]})}(i);e["default"]=r.a}},[["456b","common/runtime","common/vendor"]]]);