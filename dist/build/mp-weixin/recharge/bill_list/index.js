(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["recharge/bill_list/index"],{"04d4":function(t,e,n){},"472a":function(t,e,n){"use strict";n.r(e);var i=n("914e"),a=n("61c3");for(var r in a)"default"!==r&&function(t){n.d(e,t,function(){return a[t]})}(r);n("57eb");var s=n("2877"),o=Object(s["a"])(a["default"],i["a"],i["b"],!1,null,"58c9b250",null);e["default"]=o.exports},"57eb":function(t,e,n){"use strict";var i=n("04d4"),a=n.n(i);a.a},"61c3":function(t,e,n){"use strict";n.r(e);var i=n("9d18"),a=n.n(i);for(var r in i)"default"!==r&&function(t){n.d(e,t,function(){return i[t]})}(r);e["default"]=a.a},"914e":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=function(e){t.changeShow=!1})},a=[];n.d(e,"a",function(){return i}),n.d(e,"b",function(){return a})},"9d18":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a(n("a34a"));function a(t){return t&&t.__esModule?t:{default:t}}function r(t){return c(t)||o(t)||s()}function s(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function o(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function c(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}function l(t,e,n,i,a,r,s){try{var o=t[r](s),c=o.value}catch(l){return void n(l)}o.done?e(c):Promise.resolve(c).then(i,a)}function h(t){return function(){var e=this,n=arguments;return new Promise(function(i,a){var r=t.apply(e,n);function s(t){l(r,i,a,s,o,"next",t)}function o(t){l(r,i,a,s,o,"throw",t)}s(void 0)})}}var u={name:"rechargeBill",data:function(){return{changeShow:!1,page:1,status:0,allcost:0,allscore:0,tabInfo:[{label:"全部",val:0},{label:"待缴费",val:1},{label:"已缴费",val:2},{label:"已免缴",val:3}],dataInfo:{price:"0.00",dikou_price_max:0},list:[],checkItem:[],itemCurrent:"1",itemsInfo:[{name:"预付金",val:"1"},{name:"微信支付",val:"2"}],realPrice:0,order_id:"",isChecked:!1}},components:{},onReachBottom:function(){if(this.noData)return t.showToast({title:"暂无更多数据",icon:"none"});this.page+=1,this.getDataList()},onLoad:function(t){this.getDataList()},methods:{createOrder:function(){var e=h(i.default.mark(function e(){var n,a,r,s,o;return i.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!(this.allcost<=0)){e.next=2;break}return e.abrupt("return",t.showToast({title:"无需缴费",icon:"none"}));case 2:return n=this.checkItem.map(function(t){return t.id}),t.showLoading({mask:!0,title:"订单创建中..."}),e.prev=4,e.next=7,this.$request({url:this.$api.myrecharge.submitOrder,method:"post",data:{bill_ids:n,price:this.allcost,price_real:this.realPrice,integral:this.allscore,house_id:this.list[0].house_id}});case 7:a=e.sent,r=a.code,s=a.data,o=a.msg,1===r?(this.changeShow=!0,this.order_id=s.id):t.showToast({title:o,icon:"none"}),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](4),t.showToast({title:e.t0,icon:"none"});case 15:case"end":return e.stop()}},e,this,[[4,12]])}));function n(){return e.apply(this,arguments)}return n}(),radioChange:function(t,e){console.log(t,e),this.itemCurrent=t.detail.value},sellSave:function(){var e=h(i.default.mark(function e(){var n,a,r,s,o;return i.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=this,!("1"===this.itemCurrent&&this.realPrice>parseInt(this.dataInfo.price))){e.next=3;break}return e.abrupt("return",t.showToast({title:"余额不足，请选择其他支付方式",icon:"none"}));case 3:return t.showLoading({mask:!0,title:"支付中..."}),e.prev=4,e.next=7,this.$request({url:this.$api.myrecharge.pay,method:"post",data:{id:this.order_id,type:this.itemCurrent,price_real:this.realPrice}});case 7:a=e.sent,r=a.code,s=a.data,o=a.msg,1===r?"2"==this.itemCurrent?wx.requestPayment({timeStamp:s.timeStamp,nonceStr:s.nonceStr,package:s.package,signType:s.signType,paySign:s.paySign,success:function(e){console.log("成功",e),t.showToast({title:"充值成功",icon:"none"}),n.changeShow=!1,n.resetList()},fail:function(e){console.log("失败",e),t.showToast({title:"充值失败",icon:"none"})},complete:function(t){console.log("complete",t)}}):(t.showToast({title:"充值成功",icon:"none"}),n.changeShow=!1,n.resetList()):t.showToast({title:o,icon:"none"}),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](4),t.showToast({title:e.t0,icon:"none"});case 15:case"end":return e.stop()}},e,this,[[4,12]])}));function n(){return e.apply(this,arguments)}return n}(),checkboxChange:function(t){var e=t.detail.value;this.isChecked=0!=e.length,console.log("isChecked",this.isChecked)},checkboxItem:function(t,e,n){if(n)return!1;this.isChecked?this.checkItem.push(e):this.checkItem=this.checkItem.filter(function(t){return t.id!==e.id}),this.checkItem.length>0?(this.allcost=this.checkItem.reduce(function(t,e){return t+parseInt(e.price,10)},0),this.allscore=this.checkItem.reduce(function(t,e){return t+parseInt(e.dikou_price,10)},0),this.allscore=this.allscore>this.dataInfo.dikou_price_max?this.dataInfo.dikou_price_max:this.allscore,this.realPrice=this.allcost-this.allscore):(this.allcost=0,this.allscore=0,this.realPrice=0),console.log("总金额，总积分，实付金额",this.allcost,this.allscore,this.realPrice)},resetList:function(){this.page=1,this.noData=!1,this.allcost=0,this.allscore=0,this.realPrice=0,this.checkItem=[],this.list=[],this.getDataList()},checkTab:function(t){this.status=t.val,this.resetList()},getDataList:function(){var e=h(i.default.mark(function e(){var n,a;return i.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.showLoading({mask:!0,title:"加载中..."}),e.prev=1,e.next=4,this.$request({url:this.$api.myrecharge.bill,data:{page:this.page,status:this.status}});case 4:n=e.sent,n.code,a=n.data,n.msg,a.list.length?(this.dataInfo=a,this.list=[].concat(r(this.list),r(a.list))):this.noData=!0,e.next=11;break;case 9:e.prev=9,e.t0=e["catch"](1);case 11:t.hideLoading();case 13:case"end":return e.stop()}},e,this,[[1,9]])}));function n(){return e.apply(this,arguments)}return n}()}};e.default=u}).call(this,n("543d")["default"])}},[["ab34","common/runtime","common/vendor"]]]);